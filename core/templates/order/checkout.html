{% extends 'basses/base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
<!-- Content -->
<div class="container content-space-1 content-space-lg-2">
    <div class="row justify-content-center">
        <div class="col-lg-8">

            <h4 class="mb-3 text-center">انتخاب آدرس</h4>

            <!-- Form -->
            <form action="{% url 'order:checkout' %}" method="post" id="checkout-form">
                {% csrf_token %}

                <hr class="my-4">

                <div class="d-grid gap-2">
                    {% for address in addresses %}
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="address_id" id="address-{{ address.id }}" value="{{ address.id }}" required>
                            <label class="form-check-label" for="address-{{ address.id }}">
                                {{ address.address }} - {{ address.city }} - {{ address.state }} - {{ address.zip_code }}
                            </label>
                        </div>
                    {% empty %}
                        <p class="text-danger">هیچ آدرسی ثبت نشده است.</p>
                    {% endfor %}

                    <div class="text-end">
                        <a href="{% url 'dashboard:customer:address-list' %}">مدیریت آدرس ها</a>
                    </div>
                </div>

                <hr class="my-4">

                <!-- کد تخفیف -->
                <div class="input-group border-bottom pb-4 mb-3">
                    <input type="text" class="form-control text-center" name="coupon_code" placeholder="کد تخفیف" aria-label="کد تخفیف">
                    <button class="btn btn-primary" type="submit" name="apply_coupon">بررسی</button>
                </div>

                <hr class="my-4">

                <!-- خلاصه سفارش -->
                <div class="border-bottom pb-4 mb-4">
                    <dl class="row">
                        <dt class="col-sm-6">هزینه ارسال</dt>
                        <dd class="col-sm-12 text-sm-end mb-0">برای تهران و حومه ۳۵,۰۰۰ تومان</dd>
                        <dd class="col-sm-12 text-sm-end mb-0">برای شهرستان‌ها ۵۰,۰۰۰ تومان</dd>
                    </dl>
                </div>

                <div class="d-grid gap-3 mb-4">
                    <dl class="row">
                        <dt class="col-sm-6">جمع مبلغ کالا</dt>
                        <dd class="col-sm-6 text-sm-end mb-0">{{ total_price|floatformat:0|intcomma }} تومان</dd>
                    </dl>
                    <dl class="row">
                        <dt class="col-sm-6">مالیات (۹٪)</dt>
                        <dd class="col-sm-6 text-sm-end mb-0">{{ total_tax|intcomma }} تومان</dd>
                    </dl>
                </div>

                <div class="d-grid mb-4">
                    <button class="btn btn-primary btn-lg" type="submit" name="submit_order">ثبت نهایی</button>
                </div>

                <!-- پشتیبانی -->
                <div class="d-flex align-items-center justify-content-center mt-4">
                    <div class="svg-icon svg-icon-sm text-primary me-2">
                        <img src="{% static 'svg/illustrations/oc-hi-five.svg' %}" width="24" height="24" alt="پشتیبانی">
                    </div>
                    <span class="small">نیاز به پشتیبانی دارید؟</span>
                    <a class="link small ms-1" href="#">ارسال تیکت</a>
                </div>

            </form>
            <!-- End Form -->
        </div>
    </div>
</div>
<!-- End Content -->
{% endblock content %}
